<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 5.1.6.2 (Linux)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="2017-08-14T16:32:30.919110864"/>
	<meta name="" content=""/>
	<meta name="created" content="00:00:00">
	<meta name="changed" content="2017-08-14T11:59:05.108742632">
	<style type="text/css">
		pre.cjk { font-family: "Courier New", monospace }
	</style>
</head>
<body lang="en-US" dir="ltr">
<div id="article_content" dir="ltr">
	<h1 align="center"><span style="background: #ffff00">[Python]<font face="Noto Sans CJK SC Regular"><font size="6" style="font-size: 22pt"><span lang="zh-CN"><font face="Noto Sans CJK SC Regular"><font size="6" style="font-size: 22pt"><span lang="zh-CN">网络爬虫（三）：异常的处理和</span></font></font></span></font></font>HTTP<font face="Noto Sans CJK SC Regular"><font size="6" style="font-size: 22pt"><span lang="zh-CN"><font face="Noto Sans CJK SC Regular"><font size="6" style="font-size: 22pt"><span lang="zh-CN">状态码的分类</span></font></font></span></font></font></span></h1>
	<p><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">先来说一说</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">HTTP</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">的异常处理问题。</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><br/>
</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">当</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">urlopen</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">不能够处理一个</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">response</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">时，产生</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">urlError</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">。</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><br/>
</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">不过通常的</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">Python
	APIs</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">异常如</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">ValueError,TypeError</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">等也会同时产生。</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><br/>
</font></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">HTTPError</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">是</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">urlError</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">的子类，通常在特定</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">HTTP
	URLs</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">中产生。</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><br/>
&nbsp;<br/>
</font></font><strong><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">1.URLError</span></font></font></strong><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><br/>
</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">通常，</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">URLError</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">在没有网络连接</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">(</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">没有路由到特定服务器</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">)</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">，或者服务器不存在的情况下产生。</span></font></font></span></span></font></p>
	<p><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">这种情况下，异常同样会带有</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">&quot;reason&quot;</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">属性，它是一个</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">tuple</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">（可以理解为不可变的数组），</span></font></font></span></span></font></p>
	<p><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">包含了一个错误号和一个错误信息。</span></font></font></span></p>
	<p><span style="background: #ffff00"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">我们建一个</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">urllib2_test06.py</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">来感受一下异常的处理：</span></font></font></span></font></span></p>
	<pre class="western"><span style="background: #ffff00">import urllib2</span>

<span style="background: #ffff00">req = urllib2.Request('http://www.baibai.com')</span>

<span style="background: #ffff00">try: urllib2.urlopen(req)</span>

<span style="background: #ffff00">except urllib2.URLError, e:  </span>
<span style="background: #ffff00">    print e.reason</span></pre><p>
	<br/>
<br/>

	</p>
	<p><span style="background: #ffff00"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">按下</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">F5</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">，可以看到打印出来的内容是：</span></font></font></span></font></span></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">[Errno
	11001] getaddrinfo failed</span></font></font></p>
	<p><span style="background: #ffff00"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">也就是说，错误号是</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">11001</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">，内容是</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">getaddrinfo
	failed</font></font></span></p>
	<p><br/>
<br/>

	</p>
	<p><strong><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">2.HTTPError</span></font></font></strong><strong><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><br/>
</font></font></strong><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">服务器上每一个</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">HTTP
	</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">应答对象</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">response</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">包含一个数字</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">&quot;</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">状态码</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">&quot;</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">。</span></font></font></span></span></font></p>
	<p><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">有时状态码指出服务器无法完成请求。默认的处理器会为你处理一部分这种应答。</span></font></font></span></p>
	<p><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">例如</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">:</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">假如</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">response</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">是一个</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">&quot;</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">重定向</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">&quot;</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">，需要客户端从别的地址获取文档，</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">urllib2</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">将为你处理。</span></font></font></span></span></font></p>
	<p><span style="background: #ffff00"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">其他不能处理的，</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">urlopen</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">会产生一个</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">HTTPError</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">。</span></font></font></span></font></span></p>
	<p><span style="background: #ffff00"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">典型的错误包含</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">&quot;404&quot;(</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">页面无法找到</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">)</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">，</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">&quot;403&quot;(</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">请求禁止</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">)</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">，和</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">&quot;401&quot;(</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">带验证请求</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">)</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">。</span></font></font></span></font></span></p>
	<p><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">HTTP</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">状态码表示</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">HTTP</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">协议所返回的响应的状态。</span></font></font></span></font></span></p>
	<p><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">比如客户端向服务器发送请求，如果成功地获得请求的资源，则返回的状态码为</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">200</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">，表示响应成功。</span></font></font></span></span></font></p>
	<p><span style="background: #ffff00"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">如果请求的资源不存在，
	则通常返回</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">404</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">错误。&nbsp;
	</span></font></font></span></font></span>
	</p>
	<p><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">HTTP</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">状态码通常分为</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">5</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">种类型，分别以</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">1</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">～</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">5</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">五个数字开头，由</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">3</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">位整数组成：</span></font></font></span></font></span></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">------------------------------------------------------------------------------------------------</font></font></p>
	<p><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">200</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">：请求成功
	&nbsp; &nbsp; &nbsp;处理方式：获得响应的内容，进行处理&nbsp;</span></font></font></span></font></span></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">201</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">：请求完成，结果是创建了新资源。新创建资源的</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">URI</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">可在响应的实体中得到
	&nbsp; &nbsp;处理方式：爬虫中不会遇到&nbsp;</span></font></font></span></span></font></p>
	<p><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">202</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">：请求被接受，但处理尚未完成
	&nbsp; &nbsp;处理方式：阻塞等待&nbsp;</span></font></font></span></font></span></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">204</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">：服务器端已经实现了请求，但是没有返回新的信
	息。如果客户是用户代理，则无须为此更新自身的文档视图。
	&nbsp; &nbsp;处理方式：丢弃</span></font></font></span></span></font></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">300</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">：该状态码不被</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">HTTP/1.0</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">的应用程序直接使用，
	只是作为</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">3XX</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">类型回应的默认解释。存在多个可用的被请求资源。&nbsp;&nbsp;
	&nbsp;处理方式：若程序中能够处理，则进行进一步处理，如果程序中不能处理，则丢弃</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><br/>
301</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">：请求到的资源都会分配一个永久的</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">URL</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">，这样就可以在将来通过该</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">URL</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">来访问此资源&nbsp;&nbsp;
	&nbsp;处理方式：重定向到分配的</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">URL<br/>
302</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">：请求到的资源在一个不同的</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">URL</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">处临时保存
	&nbsp;&nbsp; &nbsp;处理方式：重定向到临时的</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">URL&nbsp;</font></font></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">304
	</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">请求的资源未更新
	&nbsp;&nbsp; &nbsp;处理方式：丢弃&nbsp;</span></font></font></span></font></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">400
	</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">非法请求
	&nbsp;&nbsp; &nbsp;处理方式：丢弃&nbsp;</span></font></font></span></font></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">401
	</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">未授权
	&nbsp;&nbsp; &nbsp;处理方式：丢弃&nbsp;</span></font></font></span></font></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">403
	</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">禁止
	&nbsp;&nbsp; &nbsp;处理方式：丢弃&nbsp;</span></font></font></span></font></p>
	<p><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">404
	</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">没有找到
	&nbsp;&nbsp; &nbsp;处理方式：丢弃&nbsp;</span></font></font></span></font></span></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">5XX
	</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">回应代码以“</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">5”</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">开头的状态码表示服务器端发现自己出现错误，不能继续执行请求
	&nbsp; &nbsp;处理方式：丢弃</span></font></font></span></font></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">------------------------------------------------------------------------------------------------</font></font></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">HTTPError</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">实例产生后会有一个整型</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">'code'</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">属性，是服务器发送的相关错误号。</span></font></font></span></font></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">Error
	Codes</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">错误码</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><br/>
</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">因为默认的处理器处理了重定向</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">(300</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">以外号码</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">)</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">，并且</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">100-299</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">范围的号码指示成功，所以你只能看到</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">400-599</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">的错误号码。</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><br/>
BaseHTTPServer.BaseHTTPRequestHandler.response</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">是一个很有用的应答号码字典，显示了</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">HTTP</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">协议使用的所有的应答号。</span></font></font></span></font></p>
	<p><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">当一个错误号产生后，服务器返回一个</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">HTTP</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">错误号，和一个错误页面。</span></font></font></span></font></p>
	<p><span style="background: #ffff00"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">你可以使用</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">HTTPError</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">实例作为页面返回的应答对象</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">response</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">。</span></font></font></span></font></span></p>
	<p><span style="background: #ffff00"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">这表示和错误属性一样，它同样包含了</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">read,geturl,</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">和</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">info</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">方法。</span></font></font></span></font></span></p>
	<p><span style="background: #ffff00"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">我们建一个</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">urllib2_test07.py</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">来感受一下：</span></font></font></span></font></span></p>
	<pre class="western"><a name="__DdeLink__4_54875380"></a><span style="background: #ffff00">import urllib2</span>
<span style="background: #ffff00">req = urllib2.Request('http://bbs.csdn.net/callmewhy')</span>

<span style="background: #ffff00">try:</span>
<span style="background: #ffff00">    urllib2.urlopen(req)</span>

<span style="background: #ffff00">except urllib2.URLError, e:</span>

<span style="background: #ffff00">    print e.code</span>
<span style="background: #ffff00">    #print e.read()</span></pre><p>
	<br/>
<font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">按下</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">F5</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">可以看见输出了</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">404</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">的错误码，也就说没有找到这个页面。</span></font></font></span></span></font></p>
	<p><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><br/>
<br/>
</font></font><strong><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">3.Wrapping</span></font></font></strong></p>
	<p style="line-height: 0.27in"><font color="#333333"><span style="background: #ffff00"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">所以如果你想为</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">HTTPError</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">或</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">URLError</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">做准备，将有两个基本的办法。推荐使用第二种。</span></font></font></span></font></span></font></p>
	<p><span style="background: #ffff00"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">我们建一个</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">urllib2_test08.py</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">来示范一下第一种异常处理的方案：</span></font></font></span></font></span></p>
	<pre class="western"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">from urllib2 import Request, urlopen, URLError, HTTPError</span></font>

<font size="3" style="font-size: 13pt"><span style="background: #ffff00">req = Request('http://bbs.csdn.net/callmewhy')</span></font>

<font size="3" style="font-size: 13pt"><span style="background: #ffff00">try:</span></font>

<span style="background: #ffff00">    <font size="3" style="font-size: 13pt">response = urlopen(req)</font></span>

<font size="3" style="font-size: 13pt"><span style="background: #ffff00">except HTTPError, e:</span></font>

<span style="background: #ffff00">    <font size="3" style="font-size: 13pt">print 'The server couldn\'t fulfill the request.'</font></span>

<span style="background: #ffff00">    <font size="3" style="font-size: 13pt">print 'Error code: ', e.code</font></span>

<font size="3" style="font-size: 13pt"><span style="background: #ffff00">except URLError, e:</span></font>

<span style="background: #ffff00">    <font size="3" style="font-size: 13pt">print 'We failed to reach a server.'</font></span>

<span style="background: #ffff00">    <font size="3" style="font-size: 13pt">print 'Reason: ', e.reason</font></span>

<font size="3" style="font-size: 13pt"><span style="background: #ffff00">else:</span></font>
<span style="background: #ffff00">    <font size="3" style="font-size: 13pt">print 'No exception was raised.'</font></span>
<span style="background: #ffff00">    <font size="3" style="font-size: 13pt"># everything is fine</font></span></pre><p style="margin-bottom: 0in">
	<br/>
<font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">和其他语言相似，</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">try</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">之后捕获异常并且将其内容打印出来。</span></font></font></span></span></font></p>
	<p style="margin-bottom: 0in; line-height: 0.27in"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">这里要注意的一点，</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">except
	HTTPError </span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">必须在第一个，否则</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">except
	URLError</span></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">将同样接受到</span></font></font></span></span></font><font color="#333333"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">HTTPError&nbsp;</span></font></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">。</span></font></font></span></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><br/>
</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">因为</span></font></font></span></span></font><font color="#333333"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">HTTPError</span></font></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font color="#333333"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">是</span></font></font></span></font></span></font><font color="#333333"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">URLError</span></font></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font color="#333333"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">的子类，如果</span></font></font></span></font></span></font><font color="#333333"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">URLError</span></font></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font color="#333333"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">在前面它会捕捉到所有的</span></font></font></span></font></span></font><font color="#333333"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">URLError</span></font></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font color="#333333"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">（包括</span></font></font></span></font></span></font><font color="#333333"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span style="background: #ffff00">HTTPError&nbsp;</span></font></font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font color="#333333"><span style="background: #ffff00"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">）。</span></font></font></span></font></span></font></p>
	<p style="margin-bottom: 0in"><br/>

	</p>
	<p><br/>
<br/>

	</p>
	<p style="line-height: 0.27in"><font color="#333333"><span style="background: #ffff00"><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">我们建一个</span></font></font></span></font><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt">urllib2_test09.py</font></font><font face="Noto Sans CJK SC Regular"><span lang="zh-CN"><font face="Microsoft YaHei"><font size="3" style="font-size: 13pt"><span lang="zh-CN">来示范一下第二种异常处理的方案：</span></font></font></span></font></span></font></p>
	<pre class="western"><span style="background: #ffff00">from urllib2 import Request, urlopen, URLError, HTTPError</span>

<span style="background: #ffff00">req = Request('http://bbs.csdn.net/callmewhy')</span>
<span style="background: #ffff00">  </span>
<span style="background: #ffff00">try:  </span>
  
<span style="background: #ffff00">    response = urlopen(req)  </span>
  
<span style="background: #ffff00">except URLError, e:  </span>

<span style="background: #ffff00">    if hasattr(e, 'code'):  </span>
  
<span style="background: #ffff00">        print 'The server couldn\'t fulfill the request.'  </span>
  
<span style="background: #ffff00">        print 'Error code: ', e.code  </span>

<span style="background: #ffff00">    elif hasattr(e, 'reason'):  </span>
  
<span style="background: #ffff00">        print 'We failed to reach a server.'  </span>
  
<span style="background: #ffff00">        print 'Reason: ', e.reason  </span>
  
  
<span style="background: #ffff00">else:  </span>
<span style="background: #ffff00">    print 'No exception was raised.'  </span>
<span style="background: #ffff00">    # everything is fine  </span></pre><p>
	<br/>
<br/>

	</p>
	<p><br/>
<br/>
<br/>

	</p>
</div>
</body>
</html>